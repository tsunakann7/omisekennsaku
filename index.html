<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>店舗マップ（営業時間付き）</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css"/>
<link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css"/>
<style>
  #map { height: 90vh; }
  .weekday-buttons button.active { font-weight: bold; }
</style>
</head>
<body>

<div id="controls">
  <div class="weekday-buttons">
    <button data-day="0" class="active">月</button>
    <button data-day="1">火</button>
    <button data-day="2">水</button>
    <button data-day="3">木</button>
    <button data-day="4">金</button>
    <button data-day="5">土</button>
    <button data-day="6">日</button>
  </div>
  <div id="time-label">時間: 12:00</div>
  <input type="range" id="time-slider" min="0" max="23" value="12">
</div>

<div id="map"></div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>
<script>


const restaurants = [
  { name:"すき家 本町店", lat:33.5590, lng:133.5310, hours:[[0,4,27],[1,4,27],[2,4,27],[3,4,27],[4,4,27],[5,4,27],[6,4,27]] },
  { name:"すき家 杉井流店", lat:33.5560, lng:133.5350, hours:[[0,4,27],[1,4,27],[2,4,27],[3,4,27],[4,4,27],[5,4,27],[6,4,27]] },
  { name:"すき家 大原町店", lat:33.5540, lng:133.5300, hours:[[0,4,27],[1,4,27],[2,4,27],[3,4,27],[4,4,27],[5,4,27],[6,4,27]] },
  { name:"すき家 潮新町店", lat:33.5580, lng:133.5400, hours:[[0,4,27],[1,4,27],[2,4,27],[3,4,27],[4,4,27],[5,4,27],[6,4,27]] },
  { name:"すき家 中万々店", lat:33.5550, lng:133.5380, hours:[[0,4,27],[1,4,27],[2,4,27],[3,4,27],[4,4,27],[5,4,27],[6,4,27]] },
  { name:"すき家 南国BP店", lat:33.5670, lng:133.5900, hours:[[0,4,27],[1,4,27],[2,4,27],[3,4,27],[4,4,27],[5,4,27],[6,4,27]] },
  { name:"すき家 土佐高岡店", lat:33.6320, lng:133.5730, hours:[[0,4,27],[1,4,27],[2,4,27],[3,4,27],[4,4,27],[5,4,27],[6,4,27]] },

  { name:"吉野家 高知 高そね店", lat:33.5580, lng:133.5400, hours:[[0,0,24],[1,0,24],[2,0,24],[3,0,24],[4,0,24],[5,0,24],[6,0,24]] },
  { name:"吉野家 高知 東町店", lat:33.5565, lng:133.5330, hours:[[0,5,27],[1,5,27],[2,5,27],[3,5,27],[4,5,27],[5,5,27],[6,5,27]] },
  { name:"吉野家 土佐バイパス店", lat:33.5620, lng:133.5500, hours:[[0,0,24],[1,0,24],[2,0,24],[3,0,24],[4,0,24],[5,0,24],[6,0,24]] },

  { name:"CoCo壱番屋 高知 はりまや橋店", lat:33.5595, lng:133.5325, hours:[[0,10.5,22],[1,10.5,22],[2,10.5,22],[3,10.5,22],[4,10.5,22],[5,10.5,22],[6,10.5,22]] },
  { name:"CoCo壱番屋 高知インター店", lat:33.5620, lng:133.5360, hours:[[0,11,24],[1,11,24],[2,11,24],[3,11,24],[4,11,24],[5,11,24],[6,11,24]] },
  { name:"CoCo壱番屋 高知 介良ケラ店", lat:33.5600, lng:133.5400, hours:[[0,10.5,23.5],[1,10.5,23.5],[2,10.5,23.5],[3,10.5,23.5],[4,10.5,23.5],[5,10.5,23.5],[6,10.5,23.5]] },
  { name:"CoCo壱番屋 高知土佐道路店", lat:33.5610, lng:133.5380, hours:[[0,10.5,22.5],[1,10.5,22.5],[2,10.5,22.5],[3,10.5,22.5],[4,10.5,22.5],[5,10.5,22.5],[6,10.5,22.5]] },
  { name:"CoCo壱番屋 香南野市店", lat:33.6580, lng:133.6120, hours:[[0,10.5,22.5],[1,10.5,22.5],[2,10.5,22.5],[3,10.5,22.5],[4,10.5,22.5],[5,10.5,22.5],[6,10.5,22.5]] },

  { name:"くら寿司 高知インター店", lat:33.5620, lng:133.5360, hours:[[0,11,23],[1,11,23],[2,11,23],[3,11,23],[4,11,23],[5,11,23],[6,11,23]] },
  { name:"くら寿司 春野店", lat:33.5500, lng:133.5200, hours:[[0,11,23],[1,11,23],[2,11,23],[3,11,23],[4,11,23],[5,11,23],[6,11,23]] },

  { name:"スシロー 高知IC店", lat:33.5625, lng:133.5350, hours:[[0,10.5,23],[1,10.5,23],[2,10.5,23],[3,10.5,23],[4,10.5,23],[5,10.5,23],[6,10.5,23]] },
  { name:"スシロー 北新町店", lat:33.5585, lng:133.5335, hours:[[0,11,23],[1,11,23],[2,11,23],[3,11,23],[4,11,23],[5,11,23],[6,11,23]] },
  { name:"スシロー 安岡店", lat:33.5560, lng:133.5300, hours:[[0,10.5,23],[1,10.5,23],[2,10.5,23],[3,10.5,23],[4,10.5,23],[5,10.5,23],[6,10.5,23]] },
  { name:"スシロー 南国店", lat:33.5670, lng:133.5900, hours:[[0,10.5,23],[1,10.5,23],[2,10.5,23],[3,10.5,23],[4,10.5,23],[5,10.5,23],[6,10.5,23]] },

  { name:"はま寿司 高知河ノ瀬店", lat:33.5630, lng:133.5400, hours:[[0,11,24],[1,11,24],[2,11,24],[3,11,24],[4,11,24],[5,11,24],[6,11,24]] },
  { name:"はま寿司 高知北金田店", lat:33.5560, lng:133.5330, hours:[[0,5,27],[1,5,27],[2,5,27],[3,5,27],[4,5,27],[5,5,27],[6,5,27]] },
  { name:"はま寿司 南国店", lat:33.5675, lng:133.5910, hours:[[0,11,23],[1,11,23],[2,11,23],[3,11,23],[4,11,23],[5,11,23],[6,11,23]] },
  { name:"はま寿司 四万十店", lat:33.5900, lng:133.6000, hours:[[0,10,23],[1,10,23],[2,10,23],[3,10,23],[4,10,23],[5,10,23],[6,10,23]] },

  { name:"マクドナルド 杉井流店", lat:33.5620, lng:133.5360, hours:[[0,0,24],[1,0,24],[2,0,24],[3,0,24],[4,0,24],[5,0,24],[6,0,24]] },
  { name:"マクドナルド 稲荷町店", lat:33.5550, lng:133.5320, hours:[[0,7,24],[1,7,24],[2,7,24],[3,7,24],[4,7,24],[5,7,24],[6,7,24]] },
  { name:"マクドナルド 帯屋町店", lat:33.5580, lng:133.5330, hours:[[0,6.5,22],[1,6.5,22],[2,6.5,22],[3,6.5,22],[4,6.5,22],[5,6.5,22],[6,6.5,22]] },
  { name:"マクドナルド 春野ケラ店", lat:33.5600, lng:133.5400, hours:[[0,7,24],[1,7,24],[2,7,24],[3,7,24],[4,7,24],[5,7,24],[6,7,24]] },
  { name:"マクドナルド 中万々店", lat:33.5550, lng:133.5380, hours:[[0,7,24],[1,7,24],[2,7,24],[3,7,24],[4,7,24],[5,7,24],[6,7,24]] },
  { name:"マクドナルド はりまや橋3F店", lat:33.5590, lng:133.5325, hours:[[0,10,21],[1,10,21],[2,10,21],[3,10,21],[4,10,21],[5,10,21],[6,10,21]] },
  { name:"マクドナルド 土佐店", lat:33.5580, lng:133.5350, hours:[[0,7,23],[1,7,23],[2,7,23],[3,7,23],[4,7,23],[5,7,23],[6,7,23]] },
  { name:"マクドナルド 五ノ瀬町店", lat:33.5595, lng:133.5315, hours:[[0,6,24],[1,6,24],[2,6,24],[3,6,24],[4,6,24],[5,6,24],[6,6,24]] },
  { name:"マクドナルド 朝倉東町店", lat:33.5555, lng:133.5325, hours:[[0,9,21],[1,9,21],[2,9,21],[3,9,21],[4,9,21],[5,9,21],[6,9,21]] },

  { name:"ミスタードーナツ 高知市内", lat:33.5580, lng:133.5330, hours:[[0,10,20],[1,10,20],[2,10,20],[3,10,20],[4,10,20],[5,10,20],[6,10,20]] },
  { name:"モスバーガー 高知市内", lat:33.5585, lng:133.5340, hours:[[0,10,21],[1,10,21],[2,10,21],[3,10,21],[4,10,21],[5,10,21],[6,10,21]] },
  { name:"ケンタッキーフライドチキン 高知店", lat:33.5590, lng:133.5350, hours:[[0,10,22],[1,10,22],[2,10,22],[3,10,22],[4,10,22],[5,10,22],[6,10,22]] },
  { name:"ほっともっと 高知各店", lat:33.5600, lng:133.5360, hours:[[0,10,22],[1,10,22],[2,10,22],[3,10,22],[4,10,22],[5,10,22],[6,10,22]] },
  { name:"なか卯 高知各店", lat:33.5570, lng:133.5320, hours:[[0,0,24],[1,0,24],[2,0,24],[3,0,24],[4,0,24],[5,0,24],[6,0,24]] },
  { name:"サーティワンアイスクリーム 高知各店", lat:33.5585, lng:133.5345, hours:[[0,10,21],[1,10,21],[2,10,21],[3,10,21],[4,10,21],[5,10,21],[6,10,21]] },
  { name:"やいろ亭（ひろめ市場内）", lat:33.5595, lng:133.5330, hours:[[0,10.5,21],[1,11.5,22],[2,11.5,22],[3,11.5,22],[4,11.5,22],[5,11.5,22],[6,11.5,22]] },
  { name:"須崎魚河岸 魚貴 追手筋店", lat:33.5615, lng:133.5363, hours:[[0,17,24],[1,17,24],[2,17,24],[3,17,24],[4,17,24],[5,17,25],[6,17,25]] },
  { name:"須崎魚河岸 魚貴 はなれ", lat:33.5616, lng:133.5364, hours:[[1,17,24],[2,17,24],[3,17,24],[4,17,24],[5,17,24],[6,17,24]] },
  { name:"須崎魚河岸 魚貴 万々店", lat:33.5535, lng:133.5335, hours:[[0,11,14],[0,17,23],[1,11,14],[1,17,23],[2,11,14],[2,17,23],[3,11,14],[3,17,23],[4,11,14],[4,17,23],[5,11,14],[5,17,23],[6,11,14],[6,17,23]] },
  { name:"菊寿し 本店", lat:33.5585, lng:133.5335, hours:[[1,11,18],[2,11,18],[4,11,18],[5,11,15],[5,17,21],[6,11,15],[6,17,21],[0,11,15],[0,17,21]] },
  { name:"追手筋 宴舞堂", lat:33.5619, lng:133.5367, hours:[[0,12,16],[0,17,25],[1,12,16],[1,17,25],[2,12,16],[2,17,25],[3,12,16],[3,17,25],[4,12,16],[4,17,25],[5,12,16],[5,17,25],[6,12,16],[6,17,27]] },
  { name:"ひろめ市場", lat:33.5590, lng:133.5325, hours:[[0,9,21],[1,9,21],[2,9,21],[3,9,21],[4,9,21],[5,9,21],[6,9,21]] }
];

// --- マップ初期化 ---
const map = L.map('map').setView([33.558, 133.536], 14);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{
  attribution:'&copy; OpenStreetMap contributors'
}).addTo(map);

// --- マーカークラスター ---
const markers = L.markerClusterGroup();
map.addLayer(markers);

// --- 曜日・時間管理 ---
let currentDay = 0;   // 月曜
let currentHour = 12; // 12時

function updateMarkers() {
  markers.clearLayers();
  const days = ["月","火","水","木","金","土","日"];
  
  restaurants.forEach(r => {
    const nowOpen = r.hours.some(h => h[0] === currentDay && currentHour >= h[1] && currentHour < h[2]);
    const status = nowOpen ? "営業中" : "閉店中";

    const hoursList = r.hours.map(h => `${days[h[0]]} ${h[1]}:00〜${h[2]}:00`).join("<br>");

    const m = L.marker([r.lat,r.lng])
      .bindPopup(`<b>${r.name}</b><br>${status}<br>${hoursList}`);
    markers.addLayer(m);
  });
}

// --- スライダーイベント ---
const slider = document.getElementById('time-slider');
const timeLabel = document.getElementById('time-label');
slider.addEventListener('input', e=>{
  currentHour = parseInt(e.target.value);
  timeLabel.textContent = `時間: ${currentHour}:00`;
  updateMarkers();
});

// --- 曜日ボタンイベント ---
document.querySelectorAll('.weekday-buttons button').forEach(btn=>{
  btn.addEventListener('click', ()=>{
    document.querySelectorAll('.weekday-buttons button').forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    currentDay = parseInt(btn.dataset.day);
    updateMarkers();
  });
});

// --- 初回描画 ---
updateMarkers();

</script>
</body>
</html>
